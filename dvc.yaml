stages:
  pull_data:
    cmd: >
      dvc pull -r origin data

  train:
    cmd: >
      python backend/train.py
      --content_path ./data/content
      --style_path ./data/style
    deps:
      - pull_data
    outs:
      - mlflow-artifacts:/models

  evaluate:
    cmd: >
      python backend/evaluate.py
      --content_path ./backend/src/imgs/gentlecat.png
      --style_index -1
      --output_path stylized.png
      --model_uri $(dvc ref -d train)
    deps:
      - train
